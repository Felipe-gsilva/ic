\section{Metodologia}

A pesquisa será conduzida em cinco etapas principais, dispostas a seguir.


\subsection{Etapa 1 - Revisão Bibliográfica}

Esta etapa permite o levantamento bibliográfico necessário para manter o projeto atualizado, proporcionar uma fundamentação teórica sólida e subsidiar a exploração proposta. A revisão focará em: (i) arquiteturas de Redes Adversariais Generativas (GANs) aplicadas à síntese de imagens médicas, com ênfase em GANs 3D-Aware (e.g., EG3D, StyleSDF) e Condicionais (cGANs), que permitem o controle sobre atributos da imagem como a pose da câmera; (ii) técnicas de aumento de dados para o treinamento de Campos de Radiância Neural (NeRF); e (iii) métricas de avaliação de estado-da-arte para modelos generativos 2D e de reconstrução 3D.


\subsection{Etapa 2 - Pré-processamento \textit{dataset} de imanges histológicas}

Dado conjunto de dados de imagens histológicas [nome] a ser utilizado, observa-se 2 desafios principais: a necessidade de pré-processamento e padronização das imagens e a organização do conjunto de dados em segmentos distintos. Estes, a seguir, serão os segmentos tratados nesta etapa:

\begin{itemize}
  \item Os NeRF's requerem os dados sobre a pose da câmera para cada imagem, ou seja, a posição e orientação da câmera no momento da captura da imagem. Para tal, é necessário que as imagens sejam organizadas em grupos, os quais contenham, individualmente, imagens de um único tecido e pose, em específico, sendo utilizado o \textit{Nerfstudio} para permitir o \textit{parsing} dos dados de entrada. 
  \item O pré-processamento subsequente incluirá a normalização de cores e resolução, assim como a possível remoção de artefatos. 
  \item  Além disso, para efeito de treinamento do modelo, é necessário que sejam estabelecidos subconjuntos de imagens, cada qual usado em diferentes contextos. Serão criados 3 conjuntos principais: \textbf{Treinamento}, \textbf{Validação} e \textbf{Teste}.
  \end{itemize}

  Os conjuntos provenientes desta etapa serão utilizados na etapa 3 e na etapa 4. 

\subsection{Etapa 3 - Treinamento e Geração de imanges}

Nesta etapa, um modelo GAN será treinado para gerar novas imagens histológicas a partir do conjunto de dados pré-processado. O modelo GAN deverá aprender as características dos tecidos histológicos presentes no \textit{dataset}, permitindo, assim, a sintetização de imagens que preservem as propriedades visuais e estruturais dos tecidos.

Em especial, serão investigados os modelos DCGAN, RAGAN e WGAN-GP, evidenciados no trabalho do Botazzo \cite{rozendo2024histdataaug}. Estas GAN's assimilam o problema da não competição gerada pelo discriminador ($D$), que usualmente tem vantagem acerca do gerador ($G$), cada um da sua maneira. No entanto, possiveis novas arquiteturas podem ser utilizadas a depender do resultado da Etapa 1.
%For instance, in DCGAN, the first GAN proposal with convolutional layers, the authors used batch normalization and leaky ReLU activations between D’s intermediate layers to make it more stable [ 11 ]. The loss function, however, was the Jensen–Shannon divergence [ 5], which can lead to mode collapse and vanishing gradients [ 8, 11]. The WGAN-GP [12] addresses these problems by using the Wasserstein distance as a loss function, which provides a more meaningful measure of the difference between the probability distributions. WGAN-GP also introduces a gradient penalty term that penalizes the norm of D’s gradients, encouraging more diverse generated samples by enforcing a more uniform distribution of gradients throughout the data space. The RAGAN [13] introduces the relativistic discriminator that estimates the probability that an authentic sample is more realistic than a fake sample and vice versa. It considers the relative realness of real and fake samples, providing more informative feedback to G. RAGAN delivers a more nuanced signal to G, allowing it to understand better how to generate plausible samples on its own and the actual data distribution.

Para a avaliação das imagens sintetizadas e posterior inserção nos \textit{datasets} de treinamento e validação, será utilizada a métrica conhecida como \textit{Fréchet Inception Distance} (FID) \cite{heusel2018ganstrainedtimescaleupdate}, que mede a distância entre as distribuições de características de imagens reais e sintéticas modelando-as como distribuições Gaussianas.

Desta forma, um dentre os GAN's supracitados será escolhido para o treinamento e a geração de novas imanges de alta qualidade para serem, posteriormente utilizadas na etapa 4, ao serem inseridas no conjunto de treinamento e validação.


\subsection{Etapa 4 - Treinamento do modelo NeRF e Criação dos volumes 3D}

O objetivo central desta etapa é avaliar o impacto do aumento de dados com GANs na qualidade da reconstrução 3D do NeRF. Para isso, serão conduzidos experimentos controlados:

\begin{itemize}
  \item \textbf{\textit{Baseline:}} Um modelo NeRF será treinado utilizando apenas o conjunto de treinamento original (real).
\item \textbf{Aumento de Dados:} Um segundo modelo NeRF será treinado com o conjunto de treinamento original aumentado com as imagens sintéticas de alta qualidade geradas na Etapa 3. A proporção de dados sintéticos será um hiperparâmetro a ser explorado.
\end{itemize}

Desta forma, poder-se-á compreender a relação entre as imagens 2D e a reconstrução 3D dos tecidos histológicos. A partir do modelo NeRF treinado, serão obtidos volumes 3D dos tecidos histológicos, permitindo a visualização das estruturas internas dos tecidos com alta fidelidade. Estes volumes produzidos serão futuramente avaliados quanto à sua qualidade e fidelidade em relação às imagens originais do \textit{dataset} na etapa 5. 

\subsection{Etapa 5 - Validação dos resultados}

Para obter-se resultados precisos, factíveis e replicáveis, este projeto buscará utilizar-se de métricas de validação dos modelos 3D reconstruídos, seja pela comparação com modelos de referência ou pela análise de poses específicas, ou seja, imagens 2D tiradas sobre o modelo.

\begin{itemize}

  \item \textbf{Validação de imangens 2D}: Serão empregados, no campo das imagens bidimensionais, tanto o PSNR (\textit{Peak Signal-To-Noise Ratio}) quanto o SSIM (\textit{Structural Similarity Index}). O PSNR faz uma comparação direta entre 2 imagens e consegue descrever o ruído discrepante entre estas, utilizando-se de uma razão sinal-ruído em escala logarítmica. Já o SSIM trabalha com a estrutura da imagem em si, ou seja, nos agrupamentos dos pixels da referência quando comparados à imagem gerada pela arquitetura GAN, capturando melhor a percepção humana de qualidade visual do que o PSNR.

  \item \textbf{Validação de modelos 3D}: Para o domínio das reconstruções 3D, utilizar-se-á o Volumetric Intersection over Union (IoU Volumétrico). Esta métrica calcula a razão entre o volume da interseção e o volume da união do modelo reconstruído e do modelo de referência, fornecendo uma medida direta da sobreposição espacial dos volumes.

Essas métricas fornecerão uma base quantitativa robusta para avaliar e comparar a qualidade dos modelos testados, dimensionando uma alta fidelidade ao obter-se valores elevados de PSNR e SSIM e de IoU Volumétrico.

\end{itemize}


A metodogolia seguirá o fluxo de trabalho a seguir, uma \textit{pipeline} estruturada para melhor entendimento das etapas, entradas e saidas:

\input{"../diagram/architecture.tex"}
